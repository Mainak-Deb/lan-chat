<!DOCTYPE html>
<html>
  <head>
    <title>RSA Encryption Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/10.3.0/jsrsasign-all-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.min.js"></script>
  </head>
  <body>
    <h1>RSA Encryption Example</h1>
    <input type="text" id="messageInput" placeholder="Type a message...">
    <button id="sendButton">Send</button>
    <script>
      // Generate RSA key pair
      const rsaKey = KEYUTIL.generateKeypair("RSA", 2048);
      const publicKey = KEYUTIL.getPEM(rsaKey.pubKeyObj);
      const privateKey = KEYUTIL.getPEM(rsaKey.prvKeyObj, "PKCS1PRV");
      console.log( publicKey)
      console.log(privateKey)

      
      // Send encrypted message to server
      function sendMessage(message) {
        const encryptedMessage = encryptRSA(publicKey, message);
        console.log(encryptedMessage);
        const decryptMessage = decryptRSA(privateKey, encryptedMessage);
        console.log(decryptRSA(privateKey, encryptedMessage));
        console.log("message length: " + message.length)
        console.log("encryption length: " + encryptedMessage.length)
        console.log(decryptMessage===message)
      }

      // Receive encrypted message from server and decrypt it
    
      // Encrypt message using public key
      function encryptRSA(publicKey, message) {
        const key = KEYUTIL.getKey(publicKey);
        const encrypted = KJUR.crypto.Cipher.encrypt(message, key);
        return btoa(encrypted);
      }

      // Decrypt message using private key
      function decryptRSA(privateKey, encryptedMessage) {
        const key = KEYUTIL.getKey(privateKey);
        const decrypted = KJUR.crypto.Cipher.decrypt(atob(encryptedMessage), key);
        return decrypted;
      }

      // Send message when button is clicked
      const sendButton = document.getElementById("sendButton");
      const messageInput = document.getElementById("messageInput");
      sendButton.addEventListener("click", () => {
        const message = messageInput.value;
        sendMessage(message);
      });
    </script>
  </body>
</html>
